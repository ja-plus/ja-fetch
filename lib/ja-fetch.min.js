function e(e,t,r){return e instanceof Promise?e:(console.warn(`${t}.interceptor.use(onFulfilled, onRejected): onRejected not return Promise.`),Promise.reject(r))}function t(e,t){const r=t.params;if(r&&(e=function(e,t){const r=new URL(e,window.location.origin);for(const e in t)if(Object.hasOwnProperty.call(t,e)){let s=t[e];void 0===s&&(s=""),r.searchParams.append(e,s)}return r.href}(e,r)),!(t.rawBody||"object"!=typeof t.body||t.body instanceof FormData)){t.headers=Object.assign({"Content-Type":"application/json"},t.headers||{});try{t.body=JSON.stringify(t.body)}catch(e){throw new Error("Can't stringify body")}}return t.credentials||(t.credentials="same-origin"),fetch(e,t)}class r{constructor(){this.store=[]}use(e,t){if(e&&"function"!=typeof e)throw new TypeError("interceptor.use(onFulfilled, onRejected), parameter onFulfilled is not a function");if(t&&"function"!=typeof t)throw new TypeError("interceptor.use(onFulfilled, onRejected), parameter onRejected is not a function");this.onFulfilled=e,this.onRejected=t;const r=Date.now();return this.store.push({id:r,onFulfilled:e,onRejected:t}),r}remove(e){e?this.store=this.store.filter((t=>t.id===e)):(console.warn("Remove all interceptors"),this.store=[])}}class s{constructor(){this.request=new r,this.response=new r}create(){return new s}use(e){let t;e instanceof s?t=e:(t=new s,e.install(t)),t.request.store.forEach((e=>{this.request.use(e.onFulfilled,e.onRejected)})),t.response.store.forEach((e=>{this.response.use(e.onFulfilled,e.onRejected)}))}}class n{constructor(e){this.defaultInit={headers:{}},this.interceptors=new s,this.defaultInit=Object.assign({},this.defaultInit,e)}create(e){return new n(e)}requestAdapter(r,s){const n=this.interceptors.request,o=this.interceptors.response;let i=Object.assign({},this.defaultInit,s);if(this.defaultInit.baseURL&&(r=this.defaultInit.baseURL+r),n.store.length){i.headers||(i.headers={});try{n.store.forEach((e=>{const t=e.onFulfilled(r,i);t&&(i=t)}))}catch(e){return Promise.reject(e)}}const c={url:r,init:i};return t(r,i).then((t=>{if(t.ok){const{responseType:r}=i;let s;return s="blob"===r?t.blob():"text"===r?t.text():"arraybuffer"===r?t.arrayBuffer():"response"===r?Promise.resolve(t):t.json(),o.store.forEach((r=>{s=s.then((e=>r.onFulfilled(e,c,t)),(t=>r.onRejected?r.onRejected(t).then((r=>e(r,"response",t))):Promise.reject(t)))})),s}{const r=Object.assign({response:t},c);let s=Promise.reject(r);return o.store.forEach((t=>{s=s.catch((e=>t.onRejected?t.onRejected(e):Promise.reject(e))).then((t=>e(t,"response",r)))})),s}}),(t=>{const r=Object.assign({err:t},c);let s=Promise.reject(r);return n.store.forEach((t=>{s=s.catch((e=>t.onRejected?t.onRejected(e):Promise.reject(e))).then((t=>e(t,"request",r)))})),s}))}request(e,t={}){return this.requestAdapter(e,t)}get(e,t={}){return t.method="GET",this.requestAdapter(e,t)}post(e,t={}){return t.method="POST",this.requestAdapter(e,t)}put(e,t={}){return t.method="PUT",this.requestAdapter(e,t)}del(e,t={}){return t.method="DELETE",this.requestAdapter(e,t)}}var o=new n;export{o as default};
//# sourceMappingURL=ja-fetch.min.js.map
